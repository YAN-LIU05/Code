============================================================

&nbsp;          NIPT 数据分析流水线项目 - 使用说明 (README)

============================================================



最后更新时间: 2025-09-07





一、项目简介

--------------------

本项目包含一套完整的 NIPT (无创产前检测) 数据分析流程，通过一系列模块化的 Python 脚本实现。

整个流水线从数据清洗开始，依次执行四个核心分析模块，涵盖了从数据探索、生物信息学质量控制 (QC)、生存分析与风险分层，到最终的决策模型建立等多个方面。





二、运行环境要求

--------------------

1\.  \*\*Python 环境\*\*: 建议使用 Python 3.8 或更高版本。

2\.  \*\*依赖库\*\*: 项目所需的所有第三方库都已记录在 `requirements.txt` 文件中。





三、首次运行前的准备步骤 (仅需一次)

--------------------

在首次运行本项目前，请务必完成以下环境配置：



1\.  \*\*解压文件\*\*: 确保项目文件夹已完整解压。



2\.  \*\*安装依赖库\*\*:

&nbsp;   a. 在当前 `代码` 文件夹的空白处，按住 `Shift` 键并单击鼠标右键，选择“在此处打开 PowerShell 窗口”或“在此处打开命令提示符”。

&nbsp;   b. 在打开的命令行窗口中，输入并执行以下命令：



&nbsp;      pip install -r requirements.txt



&nbsp;   c. 等待命令执行完毕，所有需要的库就会被自动安装。如果安装速度慢，可以考虑使用国内镜像源。





四、如何运行整个分析流程

--------------------

本项目提供了两种运行方式：



\### 方式一：一键自动运行 (推荐)



&nbsp;  直接双击 `一键运行全部脚本.bat` 文件。



&nbsp;  该脚本会自动按预设的正确顺序，依次调用并执行所有的 Python 分析程序。您只需等待程序运行结束即可。每个步骤的开始和结束都会在窗口中打印提示信息。如果中途有任何脚本出错，流水线会自动中断并提示错误。



\### 方式二：手动分步运行 (用于调试或单独分析)



&nbsp;  如果您需要单独运行某个模块，可以按照以下方式手动执行：

&nbsp;  1.  如上文所述，打开命令行窗口并进入到 `代码` 文件夹。

&nbsp;  2.  要运行根目录下的脚本 (如 `clean.py`)，直接输入：

&nbsp;      py -3 clean.py

&nbsp;  3.  要运行子文件夹内的脚本 (如 Q1 的主程序)，需要先进入该文件夹，再运行：

&nbsp;      cd Q1

&nbsp;      py -3 Q1\_main.py





五、项目文件结构说明

--------------------

本项目的代码结构清晰，按功能模块化组织：



\- `\\data.xlsx`

&nbsp; - 项目使用的原始数据文件。



\- `\\requirements.txt`

&nbsp; - 项目的 Python 依赖库列表。



\- `\\clean.py`

&nbsp; - \*\*(步骤 0)\*\* 全局的、初始的数据预处理和清洗脚本。



\- `\\一键运行全部脚本.bat`

&nbsp; - 用于自动按顺序执行所有分析的批处理文件。



\- `\\Q1\\`

&nbsp; - \*\*(步骤 1)\*\* 第一个分析模块，包含初步的数据探索与建模。

&nbsp; - `Q1\_main.py`: 该模块的主执行文件。



\- `\\Q2\\`

&nbsp; - \*\*(步骤 2)\*\* 第二个分析模块，核心是基于孕妇BMI进行分组，并预测各组的最佳NIPT时点。

&nbsp; - `Q2\_main.py`: 该模块的主执行文件。



\- `\\Q3\\`

&nbsp; - \*\*(步骤 3)\*\* 第三个分析模块，使用生存分析（Cox模型）进行风险分层，并建立决策分析模型。

&nbsp; - `Q3\_clean.py`: Q3 模块专属的数据清洗脚本。

&nbsp; - `Q3\_main.py`: 该模块的主执行文件。



\- `\\Q4\\`

&nbsp; - \*\*(步骤 4)\*\* 第四个分析模块，使用孤立森林进行异常检测，并深入分析了测序深度(QC)和GC偏倚对模型性能的影响。

&nbsp; - `Q4\_main.py`: 该模块的主执行文件。





六、执行顺序与逻辑

--------------------

`一键运行全部脚本.bat` 保证了以下正确的执行逻辑：

1\.  首先，运行根目录下的 `clean.py` 进行全局数据清洗。

2\.  然后，进入 `Q1` 文件夹，运行 `Q1\_main.py`。

3\.  接着，进入 `Q2` 文件夹，运行 `Q2\_main.py`。

4\.  之后，进入 `Q3` 文件夹，先运行 `Q3\_clean.py`，成功后再运行 `Q3\_main.py`。

5\.  最后，进入 `Q4` 文件夹，运行 `Q4\_main.py`。





七、预期输出

--------------------

脚本成功运行后，将在对应的 `Q1`, `Q2`, `Q3`, `Q4` 文件夹内生成一系列分析结果，主要包括：

\- \*\*图片文件 (.png)\*\*: 各种分析图表，如生存曲线、箱线图、热力图等。

\- \*\*数据文件 (.xlsx)\*\*: 包含中间过程或最终分群结果的数据表格。



请在运行结束后，检查各个文件夹以查看详细的分析产出。

